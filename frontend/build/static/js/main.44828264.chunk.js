(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{186:function(e,t,a){},217:function(e){e.exports={v:"5.5.2",fr:60,ip:0,op:104,w:84,h:40,nm:"Typing-Indicator",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"Oval 3",sr:1,ks:{o:{a:1,k:[{i:{x:[.643],y:[1]},o:{x:[1],y:[0]},t:18,s:[35],e:[100]},{i:{x:[.099],y:[1]},o:{x:[.129],y:[0]},t:33,s:[100],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:65,s:[35],e:[35]},{t:71}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[61,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.667,.667,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:18,s:[100,100,100],e:[140,140,100]},{i:{x:[.032,.032,.667],y:[1,1,1]},o:{x:[.217,.217,.333],y:[0,0,0]},t:33,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:65,s:[100,100,100],e:[100,100,100]},{t:71}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 3",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"Oval 2",sr:1,ks:{o:{a:1,k:[{i:{x:[.667],y:[1]},o:{x:[1],y:[0]},t:9,s:[35],e:[98]},{i:{x:[.023],y:[1]},o:{x:[.179],y:[0]},t:24,s:[98],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:56,s:[35],e:[35]},{t:62}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[41,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.654,.654,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:9,s:[100,100,100],e:[140,140,100]},{i:{x:[.11,.11,.667],y:[1,1,1]},o:{x:[.205,.205,.333],y:[0,0,0]},t:24,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:56,s:[100,100,100],e:[100,100,100]},{t:62}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 2",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:3,ty:4,nm:"Oval 1",sr:1,ks:{o:{a:1,k:[{i:{x:[.667],y:[1]},o:{x:[1],y:[0]},t:0,s:[35],e:[100]},{i:{x:[.067],y:[1]},o:{x:[.125],y:[0]},t:15,s:[100],e:[35]},{i:{x:[.833],y:[1]},o:{x:[.167],y:[0]},t:47,s:[35],e:[35]},{t:53}],ix:11,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"},r:{a:0,k:0,ix:10},p:{a:0,k:[21,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:1,k:[{i:{x:[.673,.673,.667],y:[1,1,1]},o:{x:[1,1,.333],y:[0,0,0]},t:0,s:[100,100,100],e:[140,140,100]},{i:{x:[.049,.049,.667],y:[1,1,1]},o:{x:[.198,.198,.333],y:[0,0,0]},t:15,s:[140,140,100],e:[100,100,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:47,s:[100,100,100],e:[100,100,100]},{t:53}],ix:6,x:"var $bm_rt;\n$bm_rt = loopOut('cycle', 0);"}},ao:0,shapes:[{ty:"gr",it:[{d:1,ty:"el",s:{a:0,k:[12,12],ix:2},p:{a:0,k:[0,0],ix:3},nm:"Ellipse Path 1",mn:"ADBE Vector Shape - Ellipse",hd:!1},{ty:"fl",c:{a:0,k:[.847000002861,.847000002861,.847000002861,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Oval 1",np:2,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0},{ddd:0,ind:4,ty:4,nm:"BG",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[42,20,0],ix:2},a:{a:0,k:[0,0,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-42,-20],[42,-20],[42,20],[-42,20]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"rd",nm:"Round Corners 1",r:{a:0,k:20,ix:1},ix:2,mn:"ADBE Vector Filter - RC",hd:!1},{ty:"fl",c:{a:0,k:[.96078401804,.96078401804,.96078401804,1],ix:4},o:{a:0,k:100,ix:5},r:1,bm:0,nm:"Fill 1",mn:"ADBE Vector Graphic - Fill",hd:!1},{ty:"tr",p:{a:0,k:[0,0],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"BG",np:3,cix:2,bm:0,ix:1,mn:"ADBE Vector Group",hd:!1}],ip:0,op:3600,st:0,bm:0}],markers:[]}},257:function(e,t,a){e.exports=a(329)},262:function(e,t,a){},263:function(e,t,a){},329:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(54),s=a.n(l),i=(a(262),a(263),a(366)),o=a(367),c=a(368),d=a(392),m=a(14),u=a(224),p=a(103),h=a(362),E=a(391),g=a(363),x=a(364),b=a(390),f=a(384),y=a(39);const C=Object(n.createContext)(),k=()=>Object(n.useContext)(C);var O=e=>{let{children:t}=e;const[a,l]=Object(n.useState)(),[s,i]=Object(n.useState)(),[o,c]=Object(n.useState)([]),[d,u]=Object(n.useState)(),p=Object(m.e)();return Object(n.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("userInfo"));i(e),e||p.push("/")},[p]),r.a.createElement(C.Provider,{value:{selectedChat:a,setSelectedChat:l,user:s,setUser:i,notification:o,setNotification:c,chats:d,setChats:u}},t)};var v=()=>{const[e,t]=Object(n.useState)(!1),a=Object(y.useToast)(),[l,s]=Object(n.useState)(),[i,o]=Object(n.useState)(),[c,d]=Object(n.useState)(!1),C=Object(m.e)(),{setUser:O}=k();return r.a.createElement(b.b,{spacing:"10px"},r.a.createElement(p.a,{id:"email",isRequired:!0},r.a.createElement(h.a,null,"Email Address"),r.a.createElement(E.a,{value:l,type:"email",placeholder:"Enter Your Email Address",onChange:e=>s(e.target.value)})),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Password"),r.a.createElement(g.a,{size:"md"},r.a.createElement(E.a,{value:i,onChange:e=>o(e.target.value),type:e?"text":"password",placeholder:"Enter password"}),r.a.createElement(x.a,{width:"4.5rem"},r.a.createElement(u.a,{h:"1.75rem",size:"sm",onClick:()=>t(!e)},e?"Hide":"Show")))),r.a.createElement(u.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(d(!0),!l||!i)return a({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"bottom"}),void d(!1);try{const t={headers:{"Content-type":"application/json"}},{data:n}=await f.a.post("/api/user/login",{email:l,password:i},t);a({title:"Login Successful",status:"success",duration:5e3,isClosable:!0,position:"top"}),O(n),localStorage.setItem("userInfo",JSON.stringify(n)),d(!1),C.push("/chats")}catch(e){a({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),d(!1)}},isLoading:c},"Login"),r.a.createElement(u.a,{variant:"solid",colorScheme:"red",width:"100%",onClick:()=>{s("guest@example.com"),o("123456")}},"Get Guest User Credentials"))},S=a(203);var w=()=>{const[e,t]=Object(n.useState)(!1),a=()=>t(!e),l=Object(S.a)(),s=Object(m.e)(),[i,o]=Object(n.useState)(),[c,d]=Object(n.useState)(),[y,C]=Object(n.useState)(),[k,O]=Object(n.useState)(),[v,w]=Object(n.useState)(!1);return r.a.createElement(b.b,{spacing:"5px"},r.a.createElement(p.a,{id:"first-name",isRequired:!0},r.a.createElement(h.a,null,"Name"),r.a.createElement(E.a,{placeholder:"Enter Your Name",onChange:e=>o(e.target.value)})),r.a.createElement(p.a,{id:"email",isRequired:!0},r.a.createElement(h.a,null,"Email Address"),r.a.createElement(E.a,{type:"email",placeholder:"Enter Your Email Address",onChange:e=>d(e.target.value)})),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Password"),r.a.createElement(g.a,{size:"md"},r.a.createElement(E.a,{type:e?"text":"password",placeholder:"Enter Password",onChange:e=>O(e.target.value)}),r.a.createElement(x.a,{width:"4.5rem"},r.a.createElement(u.a,{h:"1.75rem",size:"sm",onClick:a},e?"Hide":"Show")))),r.a.createElement(p.a,{id:"password",isRequired:!0},r.a.createElement(h.a,null,"Confirm Password"),r.a.createElement(g.a,{size:"md"},r.a.createElement(E.a,{type:e?"text":"password",placeholder:"Confirm password",onChange:e=>C(e.target.value)}),r.a.createElement(x.a,{width:"4.5rem"},r.a.createElement(u.a,{h:"1.75rem",size:"sm",onClick:a},e?"Hide":"Show")))),r.a.createElement(u.a,{colorScheme:"blue",width:"100%",style:{marginTop:15},onClick:async()=>{if(w(!0),!i||!c||!k||!y)return l({title:"Please Fill all the Feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"}),void w(!1);if(k===y){console.log(i,c,k);try{const t={headers:{"Content-type":"application/json"}},{data:a}=await f.a.post("/api/user",{name:i,email:c,password:k},t);console.log(a),l({title:"Registration Successful",status:"success",duration:5e3,isClosable:!0,position:"top"}),localStorage.setItem("userInfo",JSON.stringify(a)),w(!1),s.push("/chats")}catch(e){l({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),w(!1)}}else l({title:"Passwords Do Not Match",status:"warning",duration:5e3,isClosable:!0,position:"top"})},isLoading:v},"Sign Up"))};var j=function(){const e=Object(m.e)();return Object(n.useEffect)(()=>{JSON.parse(localStorage.getItem("userInfo"))&&e.push("/chats")},[e]),r.a.createElement(i.a,{maxW:"xl",centerContent:!0},r.a.createElement(o.a,{d:"flex",justifyContent:"center",p:3,bg:"white",w:"100%",m:"40px 0 15px 0",borderRadius:"lg",borderWidth:"1px"},r.a.createElement(c.a,{fontSize:"4xl",fontFamily:"Work sans"},"Chat Box")),r.a.createElement(o.a,{bg:"white",w:"100%",p:4,borderRadius:"lg",borderWidth:"1px"},r.a.createElement(d.e,{isFitted:!0,variant:"soft-rounded"},r.a.createElement(d.b,{mb:"1em"},r.a.createElement(d.a,null,"Login"),r.a.createElement(d.a,null,"Sign Up")),r.a.createElement(d.d,null,r.a.createElement(d.c,null,r.a.createElement(v,null)),r.a.createElement(d.c,null,r.a.createElement(w,null))))))},_=(a(186),a(372)),F=a(365);const A=(e,t,a,n)=>a<e.length-1&&e[a+1].sender._id===t.sender._id&&e[a].sender._id!==n?33:a<e.length-1&&e[a+1].sender._id!==t.sender._id&&e[a].sender._id!==n||a===e.length-1&&e[a].sender._id!==n?0:"auto",z=(e,t,a)=>a>0&&e[a-1].sender._id===t.sender._id,B=(e,t)=>{var a;return(null===(a=t[0])||void 0===a?void 0:a._id)===(null===e||void 0===e?void 0:e._id)?t[1].name:t[0].name},I=(e,t)=>t[0]._id===e._id?t[1]:t[0];var R=a(378),N=a(373),D=a(371),G=a(53),L=a(374);var W=e=>{let{user:t,children:a}=e;const{isOpen:n,onOpen:l,onClose:s}=Object(D.a)();return r.a.createElement(r.a.Fragment,null,a?r.a.createElement("span",{onClick:l},a):r.a.createElement(_.a,{d:{base:"flex"},icon:r.a.createElement(N.a,null),onClick:l}),r.a.createElement(G.a,{size:"lg",onClose:s,isOpen:n,isCentered:!0},r.a.createElement(G.h,null),r.a.createElement(G.d,{h:"410px"},r.a.createElement(G.g,{fontSize:"40px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},t.name),r.a.createElement(G.c,null),r.a.createElement(G.b,{d:"flex",flexDir:"column",alignItems:"center",justifyContent:"space-between"},r.a.createElement(L.a,{borderRadius:"full",boxSize:"150px",src:t.pic,alt:t.name}),r.a.createElement(c.a,{fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans"},"Email: ",t.email)),r.a.createElement(G.f,null,r.a.createElement(u.a,{onClick:s},"Close")))))},M=a(375),P=a(387),T=a(215);var U=e=>{let{messages:t}=e;const{user:a}=k();return r.a.createElement(T.a,null,t&&t.map((e,n)=>r.a.createElement("div",{style:{display:"flex"},key:e._id},(((e,t,a,n)=>a<e.length-1&&(e[a+1].sender._id!==t.sender._id||void 0===e[a+1].sender._id)&&e[a].sender._id!==n)(t,e,n,a._id)||((e,t,a)=>t===e.length-1&&e[e.length-1].sender._id!==a&&e[e.length-1].sender._id)(t,n,a._id))&&r.a.createElement(P.a,{label:e.sender.name,placement:"bottom-start",hasArrow:!0},r.a.createElement(M.a,{mt:"7px",mr:1,size:"sm",cursor:"pointer",name:e.sender.name,src:e.sender.pic})),r.a.createElement("span",{style:{backgroundColor:"".concat(e.sender._id===a._id?"#BEE3F8":"#B9F5D0"),marginLeft:A(t,e,n,a._id),marginTop:z(t,e,n,a._id)?3:10,borderRadius:"20px",padding:"5px 15px",maxWidth:"75%"}},e.content))))},V=a(216),$=a.n(V),J=a(217),q=a(218),Y=a(220),H=a.n(Y),K=a(222),Z=a(377),Q=a(376);var X=e=>{let{user:t,handleFunction:a,admin:n}=e;return r.a.createElement(Q.a,{px:2,py:1,borderRadius:"lg",m:1,mb:2,variant:"solid",fontSize:12,colorScheme:"purple",cursor:"pointer",onClick:a},t.name,n===t._id&&r.a.createElement("span",null," (Admin)"),r.a.createElement(Z.a,{pl:1}))};var ee=e=>{let{user:t,handleFunction:a}=e;return r.a.createElement(o.a,{onClick:a,cursor:"pointer",bg:"#E8E8E8",_hover:{background:"#38B2AC",color:"white"},w:"100%",d:"flex",alignItems:"center",color:"black",px:3,py:2,mb:2,borderRadius:"lg"},r.a.createElement(M.a,{mr:2,size:"sm",cursor:"pointer",name:t.name,src:t.pic}),r.a.createElement(o.a,null,r.a.createElement(c.a,null,t.name),r.a.createElement(c.a,{fontSize:"xs"},r.a.createElement("b",null,"Email : "),t.email)))};var te=e=>{let{fetchMessages:t,fetchAgain:a,setFetchAgain:l}=e;const{isOpen:s,onOpen:i,onClose:c}=Object(D.a)(),[d,m]=Object(n.useState)(),[h,g]=Object(n.useState)(""),[x,b]=Object(n.useState)([]),[C,O]=Object(n.useState)(!1),[v,S]=Object(n.useState)(!1),w=Object(y.useToast)(),{selectedChat:j,setSelectedChat:A,user:z}=k(),B=async e=>{if(j.users.find(t=>t._id===e._id))w({title:"User Already in group!",status:"error",duration:5e3,isClosable:!0,position:"top"});else if(j.groupAdmin._id===z._id){try{O(!0);const n={headers:{Authorization:"Bearer ".concat(z.token)}},{data:r}=await f.a.put("/api/chat/groupadd",{chatId:j._id,userId:e._id},n);A(r),l(!a),O(!1)}catch(t){w({title:"Error Occured!",description:t.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),O(!1)}m("")}else w({title:"Only admins can add someone!",status:"error",duration:5e3,isClosable:!0,position:"top"})},I=async e=>{if(j.groupAdmin._id===z._id||e._id===z._id){try{O(!0);const r={headers:{Authorization:"Bearer ".concat(z.token)}},{data:s}=await f.a.put("/api/chat/groupremove",{chatId:j._id,userId:e._id},r);e._id===z._id?A():A(s),l(!a),t(),O(!1)}catch(n){w({title:"Error Occured!",description:n.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),O(!1)}m("")}else w({title:"Only admins can remove someone!",status:"error",duration:5e3,isClosable:!0,position:"top"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(_.a,{d:{base:"flex"},icon:r.a.createElement(N.a,null),onClick:i}),r.a.createElement(G.a,{onClose:c,isOpen:s,isCentered:!0},r.a.createElement(G.h,null),r.a.createElement(G.d,null,r.a.createElement(G.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},j.chatName),r.a.createElement(G.c,null),r.a.createElement(G.b,{d:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(o.a,{w:"100%",d:"flex",flexWrap:"wrap",pb:3},j.users.map(e=>r.a.createElement(X,{key:e._id,user:e,admin:j.groupAdmin,handleFunction:()=>I(e)}))),r.a.createElement(p.a,{d:"flex"},r.a.createElement(E.a,{placeholder:"Chat Name",mb:3,value:d,onChange:e=>m(e.target.value)}),r.a.createElement(u.a,{variant:"solid",colorScheme:"teal",ml:1,isLoading:v,onClick:async()=>{if(d){try{S(!0);const t={headers:{Authorization:"Bearer ".concat(z.token)}},{data:n}=await f.a.put("/api/chat/rename",{chatId:j._id,chatName:d},t);console.log(n._id),A(n),l(!a),S(!1)}catch(e){w({title:"Error Occured!",description:e.response.data.message,status:"error",duration:5e3,isClosable:!0,position:"top"}),S(!1)}m("")}}},"Update")),r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Add User to group",mb:1,onChange:e=>(async e=>{if(g(e),e)try{O(!0);const e={headers:{Authorization:"Bearer ".concat(z.token)}},{data:a}=await f.a.get("/api/user?search=".concat(h),e);console.log(a),O(!1),b(a)}catch(t){w({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"top-left"}),O(!1)}})(e.target.value)})),C?r.a.createElement(F.a,{size:"lg"}):null===x||void 0===x?void 0:x.map(e=>r.a.createElement(ee,{key:e._id,user:e,handleFunction:()=>B(e)}))),r.a.createElement(G.f,null,r.a.createElement(u.a,{onClick:()=>I(z),colorScheme:"red"},"Leave Group")))))};var ae,ne;var re=e=>{let{fetchAgain:t,setFetchAgain:a}=e;const[l,s]=Object(n.useState)([]),[i,d]=Object(n.useState)(!1),[m,u]=Object(n.useState)(""),[h,g]=Object(n.useState)(!1),[x,b]=Object(n.useState)(!1),[C,O]=Object(n.useState)(!1),v=Object(n.useRef)(),S=Object(n.useRef)(),[w,j]=Object(n.useState)(!1),A=Object(y.useToast)(),z={loop:!0,autoplay:!0,animationData:J,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},{selectedChat:N,setSelectedChat:D,user:G,notification:L,setNotification:M}=k(),P=async()=>{if(N)try{const t={headers:{Authorization:"Bearer ".concat(G.token)}};d(!0);const{data:a}=await f.a.get("/api/message/".concat(N._id),t);s(a),d(!1),ae.emit("join chat",N._id)}catch(e){A({title:"Error Occured!",description:"Failed to Load the Messages",status:"error",duration:5e3,isClosable:!0,position:"top"})}};Object(n.useEffect)(()=>((ae=Object(K.a)("http://localhost:5000")).emit("setup",G),ae.on("connected",()=>g(!0)),ae.on("typing",()=>j(!0)),ae.on("stop typing",()=>j(!1)),()=>{ae.disconnect()}),[G]),Object(n.useEffect)(()=>{P(),ne=N},[N]),Object(n.useEffect)(()=>{ae.on("message recieved",e=>{ne&&ne._id===e.chat._id?s([...l,e]):L.includes(e)||(M([e,...L]),a(!t))})});Object(n.useEffect)(()=>{const e=e=>{"emoji-open"!==e.target.id&&S.current&&!S.current.contains(e.target)&&O(!1)};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[]);return r.a.createElement(r.a.Fragment,null,N?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{fontSize:{base:"28px",md:"30px"},pb:3,px:2,w:"100%",fontFamily:"Work sans",d:"flex",justifyContent:{base:"space-between"},alignItems:"center"},r.a.createElement(_.a,{d:{base:"flex",md:"none"},icon:r.a.createElement(R.a,null),onClick:()=>D("")}),l&&(N.isGroupChat?r.a.createElement(r.a.Fragment,null,N.chatName.toUpperCase(),r.a.createElement(te,{fetchMessages:P,fetchAgain:t,setFetchAgain:a})):r.a.createElement(r.a.Fragment,null,B(G,N.users),r.a.createElement(W,{user:I(G,N.users)})))),r.a.createElement(o.a,{d:"flex",flexDir:"column",justifyContent:"flex-end",p:3,bg:"#E8E8E8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden"},i?r.a.createElement(F.a,{size:"xl",w:20,h:20,alignSelf:"center",margin:"auto"}):r.a.createElement("div",{className:"messages"},r.a.createElement(U,{messages:l})),r.a.createElement(p.a,{onKeyDown:async e=>{if("Enter"===e.key&&(m||C)){ae.emit("stop typing",N._id);try{const e={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(G.token)}},a=m.replace(/[^a-zA-Z0-9]/g,"");let n=null!==m&&void 0!==m?m:"";C&&a&&(n+=a,O(!1)),u("");const{data:r}=await f.a.post("/api/message",{content:n,chatId:N},e);ae.emit("new message",r),s([...l,r])}catch(t){A({title:"Error Occurred!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"top"})}console.log("Sending message:",m),u("")}},id:"first-name",isRequired:!0,mt:3},w?r.a.createElement("div",null,r.a.createElement($.a,{options:z,width:70,style:{marginBottom:15,marginLeft:0}})):r.a.createElement(r.a.Fragment,null),r.a.createElement(E.a,{variant:"filled",bg:"#E0E0E0",placeholder:"Enter a message..",value:null!==m&&void 0!==m?m:"",onChange:e=>{if(u(e.target.value),!h)return;x||(b(!0),ae.emit("typing",N._id));let t=(new Date).getTime();setTimeout(()=>{(new Date).getTime()-t>=3e3&&x&&(ae.emit("stop typing",N._id),b(!1))},3e3)},style:{border:"2px solid blue",borderRadius:"5px",width:"92%",marginRight:"px",float:"right",clear:"both"}}),r.a.createElement(H.a,{title:"Emoji",id:"emoji-open",style:{cursor:"pointer",marginRight:"10px",fontSize:"35px"},onClick:()=>{O(!C)}}),C&&r.a.createElement("div",{className:"absolute bottom-24 left-16 z-40",ref:S},r.a.createElement(q.a,{onEmojiClick:(e,t)=>{const a=(null===e||void 0===e?void 0:e.emoji)||"";u(e=>e+(a||""))},theme:"dark"})," "),r.a.createElement("input",{type:"file",ref:v,id:"fileInput",style:{display:"none"},onChange:async e=>{},onClick:async e=>{try{const a=e.target.files[0],n=new FormData;n.append("image",a);const r=await f.a.post("/api/add-image-message",n,{headers:{"Content-Type":"multipart/form-data"},params:{chatId:N}}),i=r.data;201===r.status&&(ae.emit("new message",i),s([...l,i])),console.log(i)}catch(t){A({title:"Error Occurred!",description:"Failed to send the Message",status:"error",duration:5e3,isClosable:!0,position:"top"})}}})))):r.a.createElement(o.a,{d:"flex",alignItems:"center",justifyContent:"center",h:"100%"},r.a.createElement(c.a,{fontSize:"3xl",pb:3,fontFamily:"Work sans"},"Click on a user to start chatting")))};var le=e=>{let{fetchAgain:t,setFetchAgain:a}=e;const{selectedChat:n}=k();return r.a.createElement(o.a,{d:{base:n?"flex":"none",md:"flex"},alignItems:"center",flexDir:"column",p:3,bg:"white",w:{base:"100%",md:"68%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(re,{fetchAgain:t,setFetchAgain:a}))},se=a(379),ie=a(385);var oe=()=>r.a.createElement(b.a,null,r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}),r.a.createElement(ie.a,{height:"45px"}));var ce=e=>{let{children:t}=e;const{isOpen:a,onOpen:l,onClose:s}=Object(D.a)(),[i,c]=Object(n.useState)(),[d,m]=Object(n.useState)([]),[h,g]=Object(n.useState)(""),[x,b]=Object(n.useState)([]),[C,O]=Object(n.useState)(!1),v=Object(y.useToast)(),{user:S,chats:w,setChats:j}=k();return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{onClick:l},t),r.a.createElement(G.a,{onClose:s,isOpen:a,isCentered:!0},r.a.createElement(G.h,null),r.a.createElement(G.d,null,r.a.createElement(G.g,{fontSize:"35px",fontFamily:"Work sans",d:"flex",justifyContent:"center"},"Create Group Chat"),r.a.createElement(G.c,null),r.a.createElement(G.b,{d:"flex",flexDir:"column",alignItems:"center"},r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Chat Name",mb:3,onChange:e=>c(e.target.value)})),r.a.createElement(p.a,null,r.a.createElement(E.a,{placeholder:"Add Users eg: John, Piyush, Jane",mb:1,onChange:e=>(async e=>{if(g(e),e)try{O(!0);const e={headers:{Authorization:"Bearer ".concat(S.token)}},{data:a}=await f.a.get("/api/user?search=".concat(h),e);console.log(a),O(!1),b(a)}catch(t){v({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"top-left"})}})(e.target.value)})),r.a.createElement(o.a,{w:"100%",d:"flex",flexWrap:"wrap"},d.map(e=>r.a.createElement(X,{key:e._id,user:e,handleFunction:()=>(e=>{m(d.filter(t=>t._id!==e._id))})(e)}))),C?r.a.createElement("div",null,"Loading..."):null===x||void 0===x?void 0:x.slice(0,4).map(e=>r.a.createElement(ee,{key:e._id,user:e,handleFunction:()=>(e=>{d.includes(e)?v({title:"User already added",status:"warning",duration:5e3,isClosable:!0,position:"top"}):m([...d,e])})(e)}))),r.a.createElement(G.f,null,r.a.createElement(u.a,{onClick:async()=>{if(i&&d)try{const t={headers:{Authorization:"Bearer ".concat(S.token)}},{data:a}=await f.a.post("/api/chat/group",{name:i,users:JSON.stringify(d.map(e=>e._id))},t);j([a,...w]),s(),v({title:"New Group Chat Created!",status:"success",duration:5e3,isClosable:!0,position:"top"})}catch(e){v({title:"Failed to Create the Chat!",description:e.response.data,status:"error",duration:5e3,isClosable:!0,position:"top"})}else v({title:"Please fill all the feilds",status:"warning",duration:5e3,isClosable:!0,position:"top"})},colorScheme:"blue"},"Create Chat")))))};var de=e=>{let{fetchAgain:t}=e;const[a,l]=Object(n.useState)(),{selectedChat:s,setSelectedChat:i,user:d,chats:m,setChats:p}=k(),h=Object(S.a)();return Object(n.useEffect)(()=>{l(JSON.parse(localStorage.getItem("userInfo"))),(async()=>{try{const t={headers:{Authorization:"Bearer ".concat(d.token)}},{data:a}=await f.a.get("/api/chat",t);p(a)}catch(e){h({title:"Error Occured!",description:"Failed to Load the chats",status:"error",duration:5e3,isClosable:!0,position:"top"})}})()},[t]),r.a.createElement(o.a,{d:{base:s?"none":"flex",md:"flex"},flexDir:"column",alignItems:"center",p:3,bg:"white",w:{base:"100%",md:"31%"},borderRadius:"lg",borderWidth:"1px"},r.a.createElement(o.a,{pb:3,px:3,fontSize:{base:"28px",md:"30px"},fontFamily:"Work sans",d:"flex",w:"100%",justifyContent:"space-between",alignItems:"center"},"My Chats",r.a.createElement(ce,null,r.a.createElement(u.a,{d:"flex",fontSize:{base:"17px",md:"10px",lg:"17px"},rightIcon:r.a.createElement(se.a,null)},"New Group Chat"))),r.a.createElement(o.a,{d:"flex",flexDir:"column",p:3,bg:"#F8F8F8",w:"100%",h:"100%",borderRadius:"lg",overflowY:"hidden"},m?r.a.createElement(b.a,{overflowY:"scroll"},m.map(e=>r.a.createElement(o.a,{onClick:()=>i(e),cursor:"pointer",bg:s===e?"#38B2AC":"#E8E8E8",color:s===e?"white":"black",px:3,py:2,borderRadius:"lg",key:e._id},r.a.createElement(c.a,null,e.isGroupChat?e.chatName:B(a,e.users)),e.latestMessage&&r.a.createElement(c.a,{fontSize:"xs"},r.a.createElement("b",null,e.latestMessage.sender.name," : "),e.latestMessage.content.length>50?e.latestMessage.content.substring(0,51)+"...":e.latestMessage.content)))):r.a.createElement(oe,null)))},me=a(386),ue=a(394),pe=a(380),he=a(381),Ee=a(134),ge=a.n(Ee);var xe=function(){const[e,t]=Object(n.useState)(""),[a,l]=Object(n.useState)([]),[s,i]=Object(n.useState)(!1),[d,p]=Object(n.useState)(!1),{setSelectedChat:h,user:g,notification:x,setNotification:b,chats:y,setChats:C}=k(),O=Object(S.a)(),{isOpen:v,onOpen:w,onClose:j}=Object(D.a)(),_=Object(m.e)(),A=async e=>{console.log(e);try{p(!0);const a={headers:{"Content-type":"application/json",Authorization:"Bearer ".concat(g.token)}},{data:n}=await f.a.post("/api/chat",{userId:e},a);y.find(e=>e._id===n._id)||C([n,...y]),h(n),p(!1),j()}catch(t){O({title:"Error fetching the chat",description:t.message,status:"error",duration:5e3,isClosable:!0,position:"top-left"})}};return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.a,{d:"flex",justifyContent:"space-between",alignItems:"center",bg:"white",w:"100%",p:"5px 10px 5px 10px",borderWidth:"5px"},r.a.createElement(P.a,{label:"Search Users to chat",hasArrow:!0,placement:"bottom-end"},r.a.createElement(u.a,{variant:"ghost",onClick:w},r.a.createElement("i",{className:"fas fa-search"}),r.a.createElement(c.a,{d:{base:"none",md:"flex"},px:4},"Search User"))),r.a.createElement(c.a,{fontSize:"2xl",fontFamily:"Work sans"},"Chat-Box"),r.a.createElement("div",null,r.a.createElement(me.a,null,r.a.createElement(me.b,{p:1},r.a.createElement(ge.a,{count:x.length,effect:Ee.Effect.SCALE}),r.a.createElement(pe.a,{fontSize:"2xl",m:1})),r.a.createElement(me.e,{pl:2},!x.length&&"No New Messages",x.map(e=>r.a.createElement(me.d,{key:e._id,onClick:()=>{h(e.chat),b(x.filter(t=>t!==e))}},e.chat.isGroupChat?"New Message in ".concat(e.chat.chatName):"New Message from ".concat(B(g,e.chat.users)))))),r.a.createElement(me.a,null,r.a.createElement(me.b,{as:u.a,bg:"white",rightIcon:r.a.createElement(he.a,null)},r.a.createElement(M.a,{size:"sm",cursor:"pointer",name:g.name,src:g.pic})),r.a.createElement(me.e,null,r.a.createElement(W,{user:g},r.a.createElement(me.d,null,"My Profile")," "),r.a.createElement(me.c,null),r.a.createElement(me.d,{onClick:()=>{localStorage.removeItem("userInfo"),_.push("/")}},"Logout"))))),r.a.createElement(ue.a,{placement:"left",onClose:j,isOpen:v},r.a.createElement(G.h,null),r.a.createElement(ue.b,null,r.a.createElement(G.g,{borderBottomWidth:"1px"},"Search Users"),r.a.createElement(G.b,null,r.a.createElement(o.a,{d:"flex",pb:2},r.a.createElement(E.a,{placeholder:"Search by name or email",mr:2,value:e,onChange:e=>t(e.target.value)}),r.a.createElement(u.a,{onClick:async()=>{if(e)try{i(!0);const a={headers:{Authorization:"Bearer ".concat(g.token)}},{data:n}=await f.a.get("/api/user?search=".concat(e),a);i(!1),l(n)}catch(t){O({title:"Error Occured!",description:"Failed to Load the Search Results",status:"error",duration:5e3,isClosable:!0,position:"top-left"})}else O({title:"Please Enter something in search",status:"warning",duration:5e3,isClosable:!0,position:"top-left"})}},"Go")),s?r.a.createElement(oe,null):null===a||void 0===a?void 0:a.map(e=>r.a.createElement(ee,{key:e._id,user:e,handleFunction:()=>A(e._id)})),d&&r.a.createElement(F.a,{ml:"auto",d:"flex"})))))};var be=()=>{const[e,t]=Object(n.useState)(!1),{user:a}=k();return r.a.createElement("div",{style:{width:"100%"}},a&&r.a.createElement(xe,null),r.a.createElement(o.a,{d:"flex",justifyContent:"space-between",w:"100%",h:"91.5vh",p:"10px"},a&&r.a.createElement(de,{fetchAgain:e}),a&&r.a.createElement(le,{fetchAgain:e,setFetchAgain:t})))};var fe=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(m.a,{path:"/",component:j,exact:!0}),r.a.createElement(m.a,{path:"/chats",component:be}))};var ye=e=>{e&&e instanceof Function&&a.e(3).then(a.bind(null,396)).then(t=>{let{getCLS:a,getFID:n,getFCP:r,getLCP:l,getTTFB:s}=t;a(e),n(e),r(e),l(e),s(e)})},Ce=a(201),ke=a(85);s.a.render(r.a.createElement(Ce.a,null,r.a.createElement(ke.a,null,r.a.createElement(O,null,r.a.createElement(fe,null)))),document.getElementById("root")),ye()}},[[257,1,2]]]);
//# sourceMappingURL=main.44828264.chunk.js.map